/*
 * Device.h
 *
 *  Created on: Aug 3, 2016
 *      Author: root
 */

#ifndef DEVICE_H_
#define DEVICE_H_

#include <string>
#include <map>
#include <list>
#include <libndpi-1.8.0/libndpi/ndpi_main.h>

#include "Vulnerability.h"


class Device {
private:
	unsigned long __ip;

	std::map<const ndpi_protocol, size_t> __protocol_table;
	std::list<Vulnerability> __vul_list;
	std::string __os;

public:
	Device();
	Device(const unsigned long &);
	Device(const Device &);
	virtual ~Device();

	void set_os(const std::string);
	void add_protocol(ndpi_protocol &);
	void add_vulnerability(const Vulnerability &);
    
    void print_proto();
    
	const std::string& get_os() const;
    const std::map<const ndpi_protocol, size_t>& get_proto_table() const;
    const std::list<Vulnerability>& get_vul_list() const;
};

#endif /* DEVICE_H_ */
