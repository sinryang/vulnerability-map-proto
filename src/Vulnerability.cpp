/*
 * Vulnerability.cpp
 *
 *  Created on: Aug 18, 2016
 *      Author: root
 */

#include "Vulnerability.h"

Vulnerability::Vulnerability() :
		__id(""), __score("0.0") {
}

Vulnerability::~Vulnerability() {
}

Vulnerability::Vulnerability(const Vulnerability &_origin) :
		__id(_origin.__id), __score(_origin.__score), __targets(
				_origin.__targets) {
}

void Vulnerability::set_id(const std::string &_id) {
	__id = _id;
}

void Vulnerability::set_score(const std::string _score) {
	__score = _score;
}

void Vulnerability::add_target(const std::string &_target) {
	__targets.insert(_target);
}

const std::string& Vulnerability::get_id() const {
	return __id;
}
const std::string Vulnerability::get_score() const {
	return __score;
}

const std::set<std::string>& Vulnerability::get_targets() const {
	return __targets;
}

const bool Vulnerability::isIn(const std::string &_target) const {
	if (__targets.find(_target) == __targets.end()) return false;
	return true;
}


Vulnerability& Vulnerability::operator = (const Vulnerability &_origin) {
	__id = _origin.__id;
	__score = _origin.__score;
	__targets = _origin.__targets;

	return *this;
}

bool Vulnerability::operator() (const Vulnerability &_rhs) const {
	return __score > _rhs.__score;
}

bool Vulnerability::operator == (const Vulnerability &_rhs) const {
	if ((__id != _rhs.__id) || (__score != _rhs.__score) || (__targets != _rhs.__targets))
		return false;
	return true;
}
